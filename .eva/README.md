# EVA Evidence Registry

## Purpose

This directory contains **machine-readable evidence** generated by CI/CD pipelines and quality gates. Evidence files are the **single source of truth** for production-readiness assessments.

## Truth Rules (Layer 1 of 5-Layer Enforcement System)

1. **NO EVIDENCE = NO SCORE** - Assessments without evidence files are INVALID
2. **CI WRITES, AGENTS READ** - Only CI pipelines may write evidence files
3. **IMMUTABLE AFTER MERGE** - Evidence on main branch is locked (production-status.json is append-only)
4. **JSON FORMAT ONLY** - All evidence must be valid JSON (schema-validated)
5. **TIMESTAMPS MANDATORY** - Every evidence file must include ISO 8601 timestamp
6. **RETENTION: 90 DAYS** - Evidence older than 90 days is archived to blob storage

## Evidence Categories

| Category | Folder | Example Files |
|----------|--------|---------------|
| Code Coverage | `coverage/` | `coverage-summary.json`, `test-run.json` |
| Bundle Size | `bundle/` | `bundle-report.json` |
| Accessibility | `a11y/` | `axe-results.json`, `ux-signoff.json` |
| Security | `security/` | `npm-audit.json`, `secrets-scan.json`, `sast.json`, `sbom.json` |
| Performance | `performance/` | `lighthouse-report.json`, `benchmarks.json` |
| Quality | `quality/` | `lint.json`, `typecheck.json`, `format.json` |
| Documentation | `docs/` | `docs-check.json`, `changelog.json` |
| GC Design | `gc-design/` | `i18n-coverage.json`, `color-audit.json` |
| Translation & i18n | `i18n/` | `translation-coverage.json`, `term-bank.json` |
| Deployment | `deploy/` | `preview.json`, `rollback.json` |
| Compliance | `compliance/` | `data-residency.json`, `canada-residency-verdict.json` |
| Observability | `observability/` | `telemetry.json` |
| Administrative | `admin/` | `acceptance.json`, `story.json`, `pr-metadata.json` |

## File Format Standard

All evidence files MUST follow this structure:

```json
{
  "generated_by": "ci-workflow-name",
  "timestamp": "2025-12-15T12:00:00Z",
  "repo": "eva-orchestrator",
  "commit_sha": "abc123...",
  "branch": "main",
  "data": {
    // Evidence-specific fields here
  }
}
```

## Policy Enforcement

Evidence files are consumed by:
- **eva-policy-runner** (tools/eva-policy-runner/) - validates against policies.yml
- **ProductionAuditor** (agents/ProductionAuditor/) - generates final production-readiness report
- **GitHub Actions** (.github/workflows/ci.yml) - blocks merges on blocker failures

## Example: Coverage Evidence

```json
{
  "generated_by": "jest-coverage",
  "timestamp": "2025-12-15T12:34:56Z",
  "repo": "eva-da-2",
  "commit_sha": "e88b8c3e",
  "branch": "feature/add-citations",
  "total": {
    "lines": { "pct": 85.4 },
    "statements": { "pct": 84.2 },
    "functions": { "pct": 80.1 },
    "branches": { "pct": 78.9 }
  }
}
```

## .gitignore Rules

Evidence files are **NOT committed** to git (generated per-build). Only the folder structure is tracked.

```gitignore
# Exclude all JSON evidence files
.eva/evidence/**/*.json

# Keep folder structure
!.eva/evidence/**/.gitkeep
```

## Next Steps (Phase 1)

- CI integration: GitHub Actions workflows generate evidence files automatically
- Schema validation: JSON Schemas for each evidence type (`.eva/schemas/`)
- Evidence archiver: Move old evidence to Azure Blob Storage after 90 days

---

**Created**: 2025-12-15 (Phase 0: Enforcement System Foundation)
**Owner**: QA Master (GitHub Copilot)
**Reference**: LESSON-036 (5-Layer Enforcement System)
